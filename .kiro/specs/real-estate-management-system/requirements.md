# 需求文档

## 介绍

房屋中介管理系统是一个基于Web的应用程序，旨在帮助房屋中介管理和组织从微信等渠道获取的房源信息。系统的核心功能是利用大语言模型自动解析非结构化的房源文本，将其转换为结构化数据并存储在数据库中，从而提高房源信息管理的效率和准确性。

## 需求

### 需求 1

**用户故事：** 作为房屋中介，我希望能够在房源上传页面将从微信等渠道复制的房源文本粘贴到系统中，并通过表单确认和修改信息，以便快速准确地录入房源信息。

#### 验收标准

1. WHEN 用户访问房源上传页面 THEN 系统 SHALL 显示一个文本输入框用于粘贴房源信息
2. WHEN 用户在文本输入框粘贴房源文本 THEN 系统 SHALL 接收完整的房源描述文本
3. WHEN 用户提交房源文本 THEN 系统 SHALL 调用大模型API进行文本解析
4. WHEN 文本解析完成 THEN 系统 SHALL 将解析结果自动填入下方的结构化表单中
5. WHEN 大模型解析结果填入表单 THEN 用户 SHALL 能够查看、修改或补充任何表单字段
6. WHEN 用户确认表单信息无误 THEN 系统 SHALL 保存房源信息到数据库

### 需求 2

**用户故事：** 作为房屋中介，我希望房源上传页面提供完整的结构化表单，以便确保每套房源的信息完整性和一致性。

#### 验收标准

1. WHEN 用户查看房源上传页面 THEN 系统 SHALL 显示包含以下字段的结构化表单：小区名称、街道地址、楼层、售价/租金、房屋类型（出售/出租）、家具家电配置、装修情况
2. WHEN 用户查看表单 THEN 系统 SHALL 为每个字段提供适当的输入控件（文本框、下拉选择、数字输入等）
3. WHEN 用户填写表单 THEN 系统 SHALL 对关键字段进行实时验证（如价格格式、必填字段等）
4. WHEN 用户提交表单 THEN 系统 SHALL 验证所有必填字段已完成填写
5. WHEN 表单验证通过 THEN 系统 SHALL 将完整的房源信息保存到数据库

### 需求 3

**用户故事：** 作为房屋中介，我希望系统能够准确区分和处理租房与售房信息，以便为不同类型的房源提供专门的管理功能。

#### 验收标准

1. WHEN 大模型解析房源文本 THEN 系统 SHALL 优先识别房屋类型（租房/售房）作为最重要的分类依据
2. WHEN 系统识别为租房 THEN 系统 SHALL 将价格字段标记为"月租金"并验证价格范围合理性（500-20000元）
3. WHEN 系统识别为售房 THEN 系统 SHALL 将价格字段标记为"售价"并验证价格范围合理性（30-2000万元）
4. WHEN 用户在表单中选择房屋类型 THEN 系统 SHALL 动态调整价格字段的标签和验证规则
5. WHEN 用户在检索页面筛选 THEN 系统 SHALL 提供"租房"和"售房"的独立标签页或筛选选项
6. WHEN 用户查看房源列表 THEN 系统 SHALL 明确显示每个房源的类型标识和对应的价格单位
7. WHEN 系统无法确定房屋类型 THEN 系统 SHALL 提示用户手动选择并标记为需要确认

### 需求 4

**用户故事：** 作为房屋中介，我希望大模型能够准确识别和提取房源文本中的关键信息并自动填入表单，以便减少手动整理的工作量。

#### 验收标准

1. WHEN 大模型解析房源文本 THEN 系统 SHALL 提取小区名称信息并填入对应表单字段
2. WHEN 大模型解析房源文本 THEN 系统 SHALL 提取街道地址信息并填入对应表单字段
3. WHEN 大模型解析房源文本 THEN 系统 SHALL 提取楼层信息并填入对应表单字段
4. WHEN 大模型解析房源文本 THEN 系统 SHALL 根据房屋类型提取对应的价格信息（月租金或售价）
5. WHEN 大模型解析房源文本 THEN 系统 SHALL 提取家具家电配置信息并填入对应表单字段
6. WHEN 大模型解析房源文本 THEN 系统 SHALL 提取装修情况信息并填入对应表单字段
7. WHEN 大模型解析房源文本 THEN 系统 SHALL 提取房间配置信息（几室几厅几卫）
8. WHEN 大模型无法识别某些信息 THEN 系统 SHALL 保留对应表单字段为空，允许用户手动填写

### 需求 5

**用户故事：** 作为房屋中介，我希望能够在房源上传页面的表单中为每个房源上传和管理图片，以便更直观地展示房屋信息。

#### 验收标准

1. WHEN 用户在房源上传页面填写表单 THEN 系统 SHALL 在表单中提供图片上传功能
2. WHEN 用户上传图片 THEN 系统 SHALL 支持多张图片上传（JPG、PNG格式）
3. WHEN 图片上传完成 THEN 系统 SHALL 将图片文件存储到服务器并在数据库中记录图片路径
4. WHEN 用户在表单中预览图片 THEN 系统 SHALL 显示已上传图片的缩略图
5. WHEN 用户提交完整表单 THEN 系统 SHALL 将房源信息和关联图片一起保存
6. WHEN 用户删除房源 THEN 系统 SHALL 同时删除关联的图片文件

### 需求 6

**用户故事：** 作为房屋中介，我希望能够在房源检索页面查看、搜索、编辑和管理所有录入的房源信息，并能够方便地区分租房和售房，以便更好地为客户提供服务。

#### 验收标准

1. WHEN 用户访问房源检索页面 THEN 系统 SHALL 提供"租房"和"售房"的标签页切换功能
2. WHEN 用户选择"租房"标签 THEN 系统 SHALL 显示所有租房信息，价格显示为"元/月"
3. WHEN 用户选择"售房"标签 THEN 系统 SHALL 显示所有售房信息，价格显示为"万元"
4. WHEN 用户在检索页面使用搜索功能 THEN 系统 SHALL 根据当前标签提供对应的筛选条件（租金范围或售价范围）
5. WHEN 用户按小区名搜索 THEN 系统 SHALL 在当前房屋类型下显示该小区的房源信息
6. WHEN 用户按街道搜索 THEN 系统 SHALL 在当前房屋类型下显示该街道的房源信息
7. WHEN 用户按价格范围筛选 THEN 系统 SHALL 根据房屋类型应用对应的价格筛选逻辑
8. WHEN 用户点击某个房源 THEN 系统 SHALL 显示该房源的详细信息、类型标识和所有图片
9. WHEN 用户在检索页面编辑房源信息 THEN 系统 SHALL 允许修改所有字段包括房屋类型并保存到数据库
10. WHEN 用户删除房源 THEN 系统 SHALL 从数据库中移除该房源记录和关联图片

### 需求 7

**用户故事：** 作为房屋中介，我希望系统能够安全地存储房源数据和图片文件，并提供安全的身份验证，以便保护业务数据。

#### 验收标准

1. WHEN 房源信息被解析 THEN 系统 SHALL 将结构化数据存储到MySQL数据库
2. WHEN 图片被上传 THEN 系统 SHALL 将图片文件安全存储到服务器文件系统
3. WHEN 用户首次访问系统 THEN 系统 SHALL 要求输入用户名和密码进行身份验证
4. WHEN 用户输入错误密码 THEN 系统 SHALL 实施防暴力破解机制（如登录尝试限制、延时等）
5. WHEN 用户成功登录 THEN 系统 SHALL 创建会话并缓存登录状态一周时间
6. WHEN 登录会话超过一周 THEN 系统 SHALL 要求用户重新登录
7. WHEN 系统存储密码 THEN 系统 SHALL 使用安全的哈希算法加密存储密码
8. WHEN 数据库操作发生错误 THEN 系统 SHALL 记录错误日志并显示友好的错误信息
9. WHEN 系统处理文件上传 THEN 系统 SHALL 验证文件类型和大小限制
10. WHEN 系统连接数据库 THEN 系统 SHALL 使用安全的数据库连接配置和访问控制

### 需求 8

**用户故事：** 作为房屋中介，我希望系统界面简洁易用，以便快速完成日常的房源管理工作。

#### 验收标准

1. WHEN 用户首次访问系统 THEN 系统 SHALL 提供直观的导航菜单
2. WHEN 用户在移动设备上访问 THEN 系统 SHALL 提供响应式设计适配不同屏幕尺寸
3. WHEN 大模型解析需要时间 THEN 系统 SHALL 显示加载状态和进度提示
4. WHEN 解析结果需要用户确认 THEN 系统 SHALL 提供清晰的确认和编辑界面
5. WHEN 用户查看房源列表 THEN 系统 SHALL 显示房源缩略图和关键信息概览

### 需求 9

**用户故事：** 作为房屋中介，我希望系统能够处理各种格式的房源文本，以便适应不同来源的信息格式。

#### 验收标准

1. WHEN 房源文本包含不规范的地址描述 THEN 系统 SHALL 尽可能识别和标准化地址信息
2. WHEN 房源文本包含价格信息的不同表达方式 THEN 系统 SHALL 统一提取和格式化价格数据
3. WHEN 房源文本信息不完整 THEN 系统 SHALL 标记缺失字段并允许用户手动补充
4. IF 大模型解析失败 THEN 系统 SHALL 提供手动录入的备选方案